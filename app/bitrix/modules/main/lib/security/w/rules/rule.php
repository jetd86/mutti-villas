<? namespace Bitrix\Main\Security\W\Rules;$GLOBALS['____642793996']= array(base64_decode(''.'aXNf'.'c3RyaW5n'),base64_decode(''.'c3R'.'ydG9sb3'.'d'.'lcg=='),base64_decode('aXNfYXJyY'.'Xk='),base64_decode('a'.'XNfc'.'3'.'RyaW5n'),base64_decode('Z3pkZWNvZG'.'U='),base64_decode('YmFzZTY0'.'X2RlY'.'29k'.'ZQ=='),base64_decode('dXJ'.'s'.'Z'.'GVjb2R'.'l'),base64_decode('YXJyY'.'XlfcmV2ZXJzZ'.'Q=='),base64_decode('Z3plbmN'.'vZGU'.'='),base64_decode('Ym'.'F'.'zZTY0X2VuY'.'29'.'kZQ'.'=='),base64_decode('dXJ'.'sZW5'.'jb2Rl'),base64_decode(''.'Y'.'mluM'.'mh'.'le'.'A=='),base64_decode('aX'.'NfYX'.'Jy'.'Y'.'Xk'.'='),base64_decode('c3RydG9'.'sb3dlcg=='),base64_decode('aXNfYXJy'.'Y'.'Xk'.'='),base64_decode('am9pbg=='),base64_decode('Zm5t'.'YXRjaA=='),base64_decode('cmF'.'3d'.'XJsZGVjb2'.'Rl'),base64_decode('c'.'3Vic3Ry'),base64_decode('c3Vi'.'c'.'3Ry'),base64_decode('c'.'3RyX'.'3Jl'.'cG'.'x'.'hY2U'.'='),base64_decode('cHJlZ1'.'9xdW90ZQ=='),base64_decode(''.'cHJlZ19tY'.'XRjaA=='));if(!function_exists(__NAMESPACE__.'\\___1994923311')){function ___1994923311($_544204881){static $_135351470= false; if($_135351470 == false) $_135351470=array(''.'YWN0'.'aW9u','aW50dmFs','cG'.'F0aA==','Y29udGV4dA==','a2V'.'5cw'.'==','cHJv'.'Y'.'2Vzcw==','ZW'.'5jb2Rp'.'bmc'.'=','c'.'HJlZ'.'19yZXBsYWNl','c'.'GF0a'.'A==','Y29'.'udGV4d'.'A'.'==','a'.'2V5cw==','c'.'HJvY2Vzcw==','ZW5'.'jb2Rpbmc=',''.'cGF0dGVybg='.'=',''.'cHJlZ19'.'tYXRj'.'a'.'A==','cGF0aA==','Y'.'2'.'9'.'udGV'.'4dA==','a2V5cw==','cHJv'.'Y2V'.'zc'.'w==','Z'.'W5jb2'.'Rpbm'.'c=','cGF'.'0dG'.'Vybg'.'==',''.'c'.'G9z'.'dF9hY3Rpb24=','Y2hlY2'.'tfY'.'3NyZ'.'g='.'=','cGF0aA==','Y29'.'udGV4dA==',''.'a'.'2'.'V5c'.'w==','cHJvY2Vzcw==','ZW5jb2Rpb'.'mc=','cGF0'.'d'.'GV'.'yb'.'g==','YW'.'N0aW9'.'u','YWN0'.'aW'.'9'.'u',''.'Y'.'W'.'N0aW9u','Y'.'W'.'N'.'0'.'aW9'.'u','Y'.'WN0a'.'W'.'9u',''.'YWN0aW9u','c'.'G9zdF9hY3Rpb2'.'4'.'=',''.'ZW5'.'jb2R'.'pbmc=',''.'Z'.'W5jb2'.'Rpbmc=','ZW5'.'jb2Rpbmc=','ZW5jb2Rpb'.'m'.'c=','ZW'.'5'.'jb2'.'R'.'pbmc=','ZW5j'.'b2R'.'pb'.'mc=','Z'.'3'.'o=','Ym'.'FzZTY'.'0','dXJs',''.'aGV4',''.'Lg'.'==','Lw==',''.'aW5k'.'ZXgucGh'.'w','L'.'2luZGV'.'4LnBo'.'cA='.'=','U'.'0N'.'SS'.'V'.'BUX05BTUU=','L'.'2luZGV4Ln'.'BocA==','U0NSSV'.'BU'.'X0'.'5BTUU=','U0NSSVBUX'.'0'.'5B'.'TUU=',''.'U0NSSVBUX05B'.'TUU=','fg==',''.'fl4=','f'.'g'.'='.'=','X'.'H'.'4=','JH4=');return base64_decode($_135351470[$_544204881]);}}; use Bitrix\Main\IO\Path; use Bitrix\Main\Web\Uri; use Bitrix\Main\Security\W\Rules\Results\ModifyResult; abstract class Rule{ protected $_1773314847; protected $_15804565; protected $_183917299; protected $_1906719864; protected $_1102106084; public static function make(array $_439054858):?static{ $_439054858= static::prepareRuleParameters($_439054858); return match($_439054858[___1994923311(0)]){ ___1994923311(1) => new IntvalRule( $_439054858[___1994923311(2)], $_439054858[___1994923311(3)], $_439054858[___1994923311(4)], $_439054858[___1994923311(5)], $_439054858[___1994923311(6)]), ___1994923311(7) => new PregReplaceRule( $_439054858[___1994923311(8)], $_439054858[___1994923311(9)], $_439054858[___1994923311(10)], $_439054858[___1994923311(11)], $_439054858[___1994923311(12)], $_439054858[___1994923311(13)]), ___1994923311(14) => new PregMatchRule( $_439054858[___1994923311(15)], $_439054858[___1994923311(16)], $_439054858[___1994923311(17)], $_439054858[___1994923311(18)], $_439054858[___1994923311(19)], $_439054858[___1994923311(20)], $_439054858[___1994923311(21)]), ___1994923311(22) => new CsrfRule( $_439054858[___1994923311(23)], $_439054858[___1994923311(24)], $_439054858[___1994923311(25)], $_439054858[___1994923311(26)], $_439054858[___1994923311(27)], $_439054858[___1994923311(28)],), default => null,};} protected static function prepareRuleParameters(array $_1592409156): array{ if($GLOBALS['____642793996'][0]($_1592409156[___1994923311(29)])){ $_1592409156[___1994923311(30)]= $GLOBALS['____642793996'][1]($_1592409156[___1994923311(31)]);} elseif($GLOBALS['____642793996'][2]($_1592409156[___1994923311(32)])){ $_1914272948= $_1592409156[___1994923311(33)]; $_1592409156[___1994923311(34)]= $_1914272948[min(160,0,53.333333333333)]; $_1592409156[___1994923311(35)]= $_1914272948[round(0+0.5+0.5)];} $_1592409156[___1994923311(36)]=!empty($_1592409156[___1994923311(37)])? $_1592409156[___1994923311(38)]:[]; if($GLOBALS['____642793996'][3]($_1592409156[___1994923311(39)])){ $_1592409156[___1994923311(40)]=[$_1592409156[___1994923311(41)]];} return $_1592409156;}  public function __construct($_1773314847, $_15804565, $_183917299, $_1906719864, $_1102106084){ $this->_1773314847= $_1773314847; $this->_15804565= $this->castContext($_15804565); $this->_183917299= $this->castKeys($_183917299); $this->_1906719864= $_1906719864; $this->_1102106084= $_1102106084;} public function evaluateValue($_452492637){ if(!empty($this->_1102106084)){ foreach($this->_1102106084 as $_902449068){ $_452492637= match($_902449068){ 'gz' => $GLOBALS['____642793996'][4]($_452492637), 'base64' => $GLOBALS['____642793996'][5]($_452492637), 'url' => $GLOBALS['____642793996'][6]($_452492637), 'hex' => hex2bin($_452492637)};}} $_1375250192= $this->evaluate($_452492637); if(!empty($this->_1102106084) && $_1375250192 instanceof ModifyResult){ $_1453729450= $_1375250192->getCleanValue(); foreach($GLOBALS['____642793996'][7]($this->_1102106084) as $_902449068){ $_1453729450= match($_902449068){ ___1994923311(42) => $GLOBALS['____642793996'][8]($_1453729450), ___1994923311(43) => $GLOBALS['____642793996'][9]($_1453729450), ___1994923311(44) => $GLOBALS['____642793996'][10]($_1453729450), ___1994923311(45) => $GLOBALS['____642793996'][11]($_1453729450)};} $_1375250192= new ModifyResult($_1453729450);} return $_1375250192;} abstract public function evaluate($_452492637); protected function castContext($_15804565){ if(!$GLOBALS['____642793996'][12]($_15804565)){ $_15804565=[$_15804565];} foreach($_15804565 as $_860725325 => $_1304564204){ $_15804565[$_860725325]= $GLOBALS['____642793996'][13]($_1304564204);} return $_15804565;} protected function castKeys($_183917299){ if(!$GLOBALS['____642793996'][14]($_183917299)){ $_183917299=[$_183917299];} return $_183917299;} public function matchKey(array $_1591956642): bool{ $_1591956642= $GLOBALS['____642793996'][15](___1994923311(46), $_1591956642); foreach($this->_183917299 as $_358476097){   if($GLOBALS['____642793996'][16]($_358476097, $_1591956642)){ return true;}} return false;}  public function matchPath($_1166404115){ if($this->_1773314847 === '*'){ return true;}  $_230304692= new Uri($_1166404115); $_782003846= $_230304692->getPath(); $_782003846= $GLOBALS['____642793996'][17]($_782003846);      if(str_ends_with($_782003846, ___1994923311(47))){ $_782003846 .= ___1994923311(48);} $_782003846= Path::normalize($_782003846);  $_203216122[]= $_782003846; if(str_ends_with($_782003846, ___1994923311(49))){ $_203216122[]= $GLOBALS['____642793996'][18]($_782003846,(1024/2-512),-round(0+2.25+2.25+2.25+2.25));} elseif(str_ends_with($_SERVER[___1994923311(50)], ___1994923311(51))){ $_203216122[]= $GLOBALS['____642793996'][19]($_SERVER[___1994923311(52)],(906-2*453),-round(0+1.8+1.8+1.8+1.8+1.8));} if($_782003846 !== $_SERVER[___1994923311(53)]){ $_203216122[]= $_SERVER[___1994923311(54)];}  if(str_starts_with($this->_1773314847, ___1994923311(55))){ $_106093574= $this->_1773314847;} else{ $_106093574= ___1994923311(56). $GLOBALS['____642793996'][20](___1994923311(57), ___1994923311(58), $GLOBALS['____642793996'][21]($this->_1773314847)). ___1994923311(59);} foreach($_203216122 as $_357535021){ if($this->_1773314847 === $_357535021 || $GLOBALS['____642793996'][22]($_106093574, $_357535021)){ return true;}} return false;}  public function getPath(){ return $this->_1773314847;}  public function getContext(){ return $this->_15804565;}  public function getKeys(){ return $this->_183917299;}  public function getProcess(){ return $this->_1906719864;}}?>