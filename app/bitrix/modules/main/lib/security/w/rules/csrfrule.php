<? namespace Bitrix\Main\Security\W\Rules;if(!function_exists(__NAMESPACE__.'\\___101703107')){function ___101703107($_1122505667){static $_118622727= false; if($_118622727 == false) $_118622727=array(''.'bWFpb'.'g==',''.'T'.'25QYWdlU3RhcnQ'.'=','U0VDVV'.'JJVFlf'.'V1dB'.'T'.'ExfRVhJVA='.'=',''.'bWFpb'.'g'.'==','Y'.'3NyZg==','Y3NyZiB0b2t'.'lb'.'iBpc'.'y'.'B'.'ta'.'X'.'Nz'.'aW5n','c2VjdXJpdHk=','V'.'1dBTExfRVh'.'JVF9'.'TVF'.'J'.'J'.'Tkc'.'=');return base64_decode($_118622727[$_1122505667]);}}; use Bitrix\Main\Config\Option; use Bitrix\Main\EventManager; use Bitrix\Main\Security\W\Rules\Results\RuleAction; class CsrfRule extends PregMatchRule{ public function __construct($_1622423775, $_2202205, $_1669433292, $_545570811, $_967741658, $_1776301709){ parent::__construct($_1622423775, $_2202205, $_1669433292, $_545570811, $_967741658, $_1776301709, RuleAction::EXIT);} public function evaluate($_1086522220){ $_920754138= parent::evaluate($_1086522220); if($_920754138 !== true){  EventManager::getInstance()->addEventHandler(___101703107(0), ___101703107(1), function(){ if(!check_bitrix_sessid()){ \CEventLog::log( \CEventLog::SEVERITY_SECURITY, ___101703107(2), ___101703107(3), ___101703107(4), ___101703107(5)); if($_1567086849= Option::get(___101703107(6), ___101703107(7))){ echo $_1567086849;} exit;}});} return true;}}?>